{
  "defaults": {
    "baseUrl": "https://api.example.com",
    "headers": {
      "Content-Type": "application/json"
    },
    "validations": [
      {
        "httpStatusCode": 200
      }
    ]
  },
  "nodes": [
    {
      "id": "authenticate",
      "name": "Authenticate",
      "method": "POST",
      "url": "/login",
      "body": {
        "username": "demo",
        "password": "demo123"
      },
      "validations": [
        {
          "jsonpath": ".token",
          "exists": true
        }
      ]
    },
    {
      "id": "get-user-profile",
      "name": "Get user profile",
      "method": "GET",
      "url": "/profile",
      "headers": {
        "Authorization": "Bearer {{ .responses.authenticate.token }}"
      },
      "validations": [
        {
          "jsonpath": ".id",
          "exists": true
        }
      ]
    },
    {
      "id": "update-premium-user-settings",
      "name": "Update premium user settings",
      "method": "PUT",
      "url": "/users/{{ .responses.get-user-profile.id }}/settings",
      "headers": {
        "Authorization": "Bearer {{ .responses.authenticate.token }}"
      },
      "body": {
        "theme": "dark",
        "notifications": true
      },
      "condition": {
        "response": 1,
        "field": ".isPremium",
        "equals": "true"
      },
      "validations": [
        {
          "jsonpath": ".success",
          "equals": "true"
        }
      ]
    },
    {
      "id": "send-welcome-email-only-for-new-users",
      "name": "Send welcome email (only for new users)",
      "method": "POST",
      "url": "/emails/welcome",
      "headers": {
        "Authorization": "Bearer {{ .responses.authenticate.token }}"
      },
      "body": {
        "userId": "{{ .responses.get-user-profile.id }}",
        "email": "{{ .responses.get-user-profile.email }}"
      },
      "condition": {
        "response": 1,
        "field": ".isNewUser",
        "equals": "true"
      }
    },
    {
      "id": "handle-authentication-failure",
      "name": "Handle authentication failure",
      "method": "POST",
      "url": "/audit/login-failed",
      "body": {
        "username": "demo",
        "timestamp": "2024-01-01T00:00:00Z"
      },
      "condition": {
        "response": 0,
        "statusCode": 401
      },
      "validations": [
        {
          "httpStatusCode": 201
        }
      ]
    },
    {
      "id": "fetch-updated-profile",
      "name": "Fetch updated profile",
      "method": "GET",
      "url": "/profile",
      "headers": {
        "Authorization": "Bearer {{ .responses.authenticate.token }}"
      },
      "condition": {
        "response": 0,
        "statusCode": 200
      }
    },
    {
      "id": "verify-admin-access",
      "name": "Verify admin access",
      "method": "GET",
      "url": "/admin/dashboard",
      "headers": {
        "Authorization": "Bearer {{ .responses.authenticate.token }}"
      },
      "condition": {
        "response": 1,
        "field": ".role",
        "equals": "admin"
      }
    },
    {
      "id": "enable-notifications-if-disabled",
      "name": "Enable notifications if disabled",
      "method": "POST",
      "url": "/users/{{ .responses.get-user-profile.id }}/notifications/enable",
      "headers": {
        "Authorization": "Bearer {{ .responses.authenticate.token }}"
      },
      "condition": {
        "response": 1,
        "field": ".notificationsEnabled",
        "notEquals": "true"
      }
    },
    {
      "id": "logout",
      "name": "Logout",
      "method": "POST",
      "url": "/logout",
      "headers": {
        "Authorization": "Bearer {{ .responses.authenticate.token }}"
      },
      "condition": {
        "response": 0,
        "statusCode": 200
      }
    }
  ]
}
